---
- name: Install PostgreSQL for Debian
  ansible.builtin.apt:
    name: "{{ item }}"
    state: present
    update_cache: true
  with_items:
    - acl
    - postgresql-13
    - postgresql-client-13
    - python3-psycopg2
  when: ansible_facts['os_family'] == 'Debian'
  tags:
    - installation-debian

- name: Import Centos Official (workaround for https://bugzilla.redhat.com/show_bug.cgi?id=2184640)
  ansible.builtin.rpm_key:
    state: present
    key: /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
  when: ansible_facts['os_family'] == 'RedHat'
  tags:
    - installation-redhat

- name: Install PostgreSQL for Centos
  ansible.builtin.dnf:
    name: "{{ item }}"
    state: present
    update_cache: true
  with_items:
    - postgresql-server
    - python3-psycopg2
  when: ansible_facts['os_family'] == 'RedHat'
  tags:
    - installation-redhat